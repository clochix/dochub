define(["jQuery","Underscore","Backbone","views/searchheader"],function(a,b,c,d){var e=2,f=d.extend({initialize:function(){b.bindAll(this,"render","addBindings","removeBindings","searchFunc"),this.placeholder=this.options.placeholder,this.languageName=this.options.languageName.toLowerCase(),this.lastQuery=null,this.debounceTime=this.options.debounceTime?this.options.debounceTime:DEFAULT_SEARCH_DEBOUNCE_MS,this.minQueryLength=this.options.minQueryLength?this.options.minQueryLength:e,this.onSearch=b.debounce(this.searchFunc,this.debounceTime),b.bindAll(this,"onSearch"),this.$searchBox=a("#search-box"),this.$searchResults=a("#search-results"),this.alphaNumRegex=/\w+/,this.addBindings()},searchFunc:function(){var b=a.trim(this.$searchBox.val()).toLowerCase();c.history.navigate(this.languageName+"/"+b,{trigger:!1});var d=b!=="";if(d&&(b===this.lastQuery||b.length<this.minQueryLength||!this.alphaNumRegex.test(b)))return;this.lastQuery=b;if(!d)this.options.pages.each(function(a){a.set({mainVisible:!1})}),this.options.pageElements.each(function(a){a.set({tocVisible:!0})});else{console.log("[Searching for "+b+".]");var e={};for(var f=0;f<this.options.pages.length;++f){var g=this.options.pages.at(f);e[g.get("title")]=!1}b=new RegExp(b);var h=null;for(var f=0;f<this.options.pageElements.length;++f){var i=this.options.pageElements.at(f),j=b.test(i.get("lowerCaseTitle"));i.set({tocVisible:j}),j&&(h===null&&(h=i),e[this.options.nameToPageMap[i.get("name")].get("title")]=j)}for(var f=0;f<this.options.pages.length;++f){var g=this.options.pages.at(f);g.set({mainVisible:e[g.get("title")]})}h!==null&&(topVal=a(document.getElementById(h.get("domId"))).offset().top,this.$searchResults.scrollTop(this.$searchResults.scrollTop()+topVal-60))}}});return f})