define(["jQuery","Underscore","Backbone","views/tocbar","views/searchheader","views/searchresults","text!templates/tocresult.html","text!templates/sectionscrape.html"],function(a,b,c,d,e,f,g,h){var i=c.View.extend({initialize:function(){b.bindAll(this,"render","setActive","setQuery"),this.active=!1,this.languageName=this.options.languageName,this.createAndRenderViews=b.once(function(){console.log("[Rendering "+this.languageName+".]"),this.searchResultsDiv=a("#search-results"),this.tocBarView=new d({el:"#toc",collection:this.collection,languageName:this.languageName}),this.tocBarView.render(),this.searchHeaderView=new e({el:"#search-header",collection:this.collection,placeholder:this.options.placeholder,languageName:this.languageName,debounceTime:this.options.debounceTime});var b=this.options.tocSearchResultsView?this.tocSearchResultsView:f;this.tocResultsView=new b({el:"#toc-results",collection:this.collection,itemTemplate:g,itemViewOptions:{tagName:"li"},languageName:this.languageName,visibleField:"tocVisible"});var c=this.options.mainSearchResultsView?this.options.mainSearchResultsView:f;this.mainResultsView=new c({el:"#search-results",collection:this.collection,itemTemplate:this.options.mainResultTemplate?this.options.mainResultTemplate:h,visibleField:"mainVisible",languageName:this.languageName,spinner:!0})})},render:function(){return this.createAndRenderViews(),this.searchHeaderView.render(),this},setActive:function(a){console.log("[setActive: "+this.languageName+" = "+a+".]");if(a&&!this.active){this.render(),this.searchResultsDiv.addClass(this.options.resultsClassNames);if(this.collection.length>0)this.searchHeaderView.addBindings(),this.tocBarView.addBindings(),this.searchHeaderView.onSearch(),this.active=!0;else{console.log("[Fetching "+this.languageName+".]"),this.mainResultsView.startSpinner();var b=this;this.collection.fetch({success:function(a,c){console.log("[Success fetching "+b.languageName+".]"),b.searchHeaderView.lastQuery=null,b.searchHeaderView.onSearch(),b.mainResultsView.spinner.stop(),b.active=!0}})}}else!a&&this.active&&(this.searchHeaderView.removeBindings(),this.tocBarView.removeBindings(),this.collection.each(function(a){a.set({tocVisible:!1,mainVisible:!1})}),this.active=!1,this.searchHeaderView.lastQuery=null,this.searchResultsDiv.removeClass(this.options.resultsClassNames))},setQuery:function(a){this.searchHeaderView.$("#search-box").val(a),this.searchHeaderView.onSearch()}});return i})